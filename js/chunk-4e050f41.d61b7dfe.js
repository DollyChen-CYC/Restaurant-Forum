(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e050f41"],{"25f0":function(t,e,r){"use strict";var n=r("e330"),s=r("5e77").PROPER,a=r("6eeb"),i=r("825a"),c=r("3a9b"),u=r("577e"),o=r("d039"),d=r("ad6d"),l="toString",m=RegExp.prototype,f=m[l],p=n(d),v=o((function(){return"/a/b"!=f.call({source:"a",flags:"b"})})),b=s&&f.name!=l;(v||b)&&a(RegExp.prototype,l,(function(){var t=i(this),e=u(t.source),r=t.flags,n=u(void 0===r&&c(m,t)&&!("flags"in m)?p(t):r);return"/"+e+"/"+n}),{unsafe:!0})},6135:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container py-5"},[r("AdminNav"),r("AdminUsersForm",{attrs:{"initial-user-list":t.userList}})],1)},s=[],a=r("1da1"),i=(r("96cf"),r("e04c")),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("table",{staticClass:"table"},[t._m(0),r("tbody",t._l(t.userList,(function(e){return r("tr",{key:e.id},[r("th",{attrs:{scope:"row"}},[t._v(" "+t._s(e.id)+" ")]),r("td",[t._v(t._s(e.name))]),r("td",[t._v(t._s(e.email))]),r("td",[t._v(t._s(t._f("showUserRole")(e.isAdmin)))]),r("td",{staticClass:"text-center"},[e.id!==t.currentUser.id?[e.isAdmin?r("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button"},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),t.toggleUserAdmin(e.id,e.isAdmin)}}},[t._v(" set as User ")]):r("button",{staticClass:"btn btn-sm",attrs:{type:"button"},on:{click:function(r){return r.preventDefault(),r.stopPropagation(),t.toggleUserAdmin(e.id,e.isAdmin)}}},[t._v(" set as Admin ")])]:t._e()],2)])})),0)])},u=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",{staticClass:"thead-dark"},[r("tr",[r("th",{attrs:{scope:"col"}},[t._v("#")]),r("th",{attrs:{scope:"col"}},[t._v("Name")]),r("th",{attrs:{scope:"col"}},[t._v("Email")]),r("th",{attrs:{scope:"col"}},[t._v("Role")]),r("th",{staticClass:"text-center",attrs:{scope:"col",width:"140"}},[t._v("Action")])])])}],o=r("5530"),d=(r("d3b7"),r("25f0"),r("d81d"),r("2f62")),l=r("be6c"),m=r("2fa3"),f={props:{initialUserList:{type:Array,required:!0}},data:function(){return{userList:this.initialUserList}},computed:Object(o["a"])({},Object(d["b"])(["currentUser"])),watch:{initialUserList:function(t){this.userList=t}},methods:{toggleUserAdmin:function(t,e){var r=this;return Object(a["a"])(regeneratorRuntime.mark((function n(){var s,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,l["a"].users.setAdmin({userId:t,isAdmin:(!e).toString()});case 3:if(s=n.sent,a=s.data,"success"===a.status){n.next=7;break}throw new Error(a.message);case 7:r.userList=r.userList.map((function(e){return e.id===t?Object(o["a"])(Object(o["a"])({},e),{},{isAdmin:!e.isAdmin}):e})),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](0),m["a"].fire({icon:"error",title:"無法修改使用者權限，請稍後再試"});case 13:case"end":return n.stop()}}),n,null,[[0,10]])})))()}},filters:{showUserRole:function(t){return t?"Admin":"User"}}},p=f,v=r("2877"),b=Object(v["a"])(p,c,u,!1,null,null,null),g=b.exports,h={components:{AdminNav:i["a"],AdminUsersForm:g},data:function(){return{userList:[]}},created:function(){this.fetchUsersData()},methods:{fetchUsersData:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var r,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].users.getUsers();case 3:if(r=e.sent,n=r.data,n.users){e.next=7;break}throw new Error("error");case 7:t.userList=n.users,e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](0),m["a"].fire({icon:"error",title:"無法取得使用者清單，請稍後再試"});case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))()}}},_=h,A=Object(v["a"])(_,n,s,!1,null,null,null);e["default"]=A.exports},ad6d:function(t,e,r){"use strict";var n=r("825a");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},be6c:function(t,e,r){"use strict";r("b0c0");var n=r("2fa3");e["a"]={categories:{get:function(){return n["b"].get("admin/categories")},create:function(t){var e=t.name;return n["b"].post("/admin/categories",{name:e})},update:function(t){var e=t.categoryId,r=t.name;return n["b"].put("/admin/categories/".concat(e),{name:r})},delete:function(t){var e=t.categoryId;return n["b"].delete("/admin/categories/".concat(e))}},restaurants:{create:function(t){var e=t.formData;return n["b"].post("/admin/restaurants",e)},getDetail:function(t){var e=t.restaurantId;return n["b"].get("/admin/restaurants/".concat(e))},getAdminRestaurants:function(){return n["b"].get("/admin/restaurants")},deleteRestaurant:function(t){var e=t.restaurantId;return n["b"].delete("/admin/restaurants/".concat(e))},updateDetail:function(t){var e=t.restaurantId,r=t.formData;return n["b"].put("/admin/restaurants/".concat(e),r)}},users:{getUsers:function(){return Object(n["b"])("/admin/users")},setAdmin:function(t){var e=t.userId,r=t.isAdmin;return n["b"].put("/admin/users/".concat(e),{isAdmin:r})}}}},e04c:function(t,e,r){"use strict";var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mb-3"},[r("h1",[t._v("餐廳後台")]),r("router-link",{attrs:{to:{name:"admin-restaurants"}}},[t._v("Restaurants")]),t._v(" | "),r("router-link",{attrs:{to:{name:"admin-categories"}}},[t._v("Categories")]),t._v(" | "),r("router-link",{attrs:{to:{name:"admin-users"}}},[t._v("Users")])],1)},s=[],a=r("2877"),i={},c=Object(a["a"])(i,n,s,!1,null,null,null);e["a"]=c.exports}}]);
//# sourceMappingURL=chunk-4e050f41.d61b7dfe.js.map