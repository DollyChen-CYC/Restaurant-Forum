(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab43a"],{1511:function(e,r,t){"use strict";t.r(r);var s=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"container py-3"},[t("div",{staticClass:"album py-5"},[t("div",{staticClass:"container"},[t("UserProfileCard",{attrs:{userProfile:e.userProfile,isFollowed:e.isFollowed,currentUser:e.currentUser},on:{"toggle-following-status":e.toggleFollowingStatus}}),t("div",{staticClass:"row"},[t("div",{staticClass:"col-md-4"},[t("UserFollowingsCard",{attrs:{userProfile:e.userProfile}}),t("UserFollowersCard",{attrs:{userProfile:e.userProfile}})],1),t("div",{staticClass:"col-md-8"},[t("UserCommentsCard",{attrs:{userProfile:e.userProfile}}),t("br"),t("UserFavoritedRestaurantsCard",{attrs:{userProfile:e.userProfile}})],1)])],1)])])},a=[],i=t("1da1"),l=t("5530"),o=(t("96cf"),t("b0c0"),t("4de4"),t("d3b7"),function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card mb-4"},[t("div",{staticClass:"row no-gutters"},[t("div",{staticClass:"col-sm-7 col-md-5 col-lg-4"},[t("img",{attrs:{src:e._f("emptyAvatar")(e.userProfile.image),width:"300px",height:"300px"}})]),t("div",{staticClass:"col-sm-5 col-md-7 col-lg-8"},[t("div",{staticClass:"card-body"},[t("h5",{staticClass:"card-title"},[e._v(e._s(e.userProfile.name))]),t("p",{staticClass:"card-text"},[e._v(e._s(e.userProfile.email))]),t("ul",{staticClass:"list-unstyled list-inline"},[t("li",[t("strong",[e._v(e._s(e.userProfile.Comments.length))]),e._v(" 已評論餐廳 ")]),t("li",[t("strong",[e._v(e._s(e.userProfile.FavoritedRestaurants.length))]),e._v(" 收藏的餐廳 ")]),t("li",[t("strong",[e._v(e._s(e.userProfile.Followings.length))]),e._v(" followings (追蹤者) ")]),t("li",[t("strong",[e._v(e._s(e.userProfile.Followers.length))]),e._v(" followers (追隨者) ")])]),e.currentUser.isAdmin||e.currentUser.id==e.userProfile.id?t("router-link",{staticClass:"btn btn-secondary me-2",attrs:{to:{name:"user-edit",params:{id:e.userProfile.id}}}},[e._v("編輯")]):e._e(),e.currentUser.id!=e.userProfile.id?t("form",{staticStyle:{display:"contents"},attrs:{action:"/following/2",method:"POST"},on:{submit:function(r){return r.stopPropagation(),r.preventDefault(),e.handleFollowingClick(e.userProfile.id)}}},[e.isFollowed?t("button",{staticClass:"btn btn-danger",attrs:{type:"submit"}},[e._v(" 取消追蹤 ")]):t("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("追蹤")])]):e._e(),t("p")],1)])])])}),n=[],c=t("2708"),u={props:{userProfile:{type:Object,required:!0},isFollowed:{type:Boolean,defalt:!1},currentUser:{type:Object,required:!0}},mixins:[c["a"]],methods:{handleFollowingClick:function(e){this.$emit("toggle-following-status",e)}}},d=u,f=t("2877"),m=Object(f["a"])(d,o,n,!1,null,null,null),v=m.exports,g=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[e._v(e._s(e.userProfile.Followings.length))]),e._v(" followings (追蹤者) ")]),t("div",{staticClass:"card-body"},e._l(e.userProfile.Followings,(function(r){return t("router-link",{key:r.id,staticClass:"m-1",attrs:{to:{name:"user",params:{id:r.id}}}},[t("img",{staticClass:"avatar rounded-1",attrs:{src:e._f("emptyAvatar")(r.image),width:"60",height:"60"}})])})),1)])},p=[],w={props:{userProfile:{type:Object,required:!0}},mixins:[c["a"]]},h=w,C=Object(f["a"])(h,g,p,!1,null,null,null),b=C.exports,_=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[e._v(e._s(e.userProfile.Followers.length))]),e._v(" followers (追隨者) ")]),t("div",{staticClass:"card-body"},e._l(e.userProfile.Followers,(function(r){return t("router-link",{key:r.id,staticClass:"m-1",attrs:{to:{name:"user",params:{id:r.id}}}},[t("img",{staticClass:"avatar rounded-1",attrs:{src:e._f("emptyAvatar")(e.userProfile.image),width:"60",height:"60"}})])})),1)])},P=[],F={props:{userProfile:{type:Object,required:!0}},mixins:[c["a"]]},y=F,U=Object(f["a"])(y,_,P,!1,null,null,null),x=U.exports,k=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[e._v(e._s(e.userProfile.Comments.length))]),e._v(" 已評論餐廳")]),t("div",{staticClass:"card-body"},e._l(e.userProfile.Comments,(function(e){return t("router-link",{key:e.id,attrs:{to:{name:"restaurant",params:{id:e.Restaurant.id}}}},[t("img",{staticClass:"avatar m-1 rounded-1",attrs:{src:e.Restaurant.image,width:"60",height:"60"}})])})),1)])},O=[],j={props:{userProfile:{type:Object,required:!0}}},R=j,E=Object(f["a"])(R,k,O,!1,null,null,null),$=E.exports,q=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header"},[t("strong",[e._v(e._s(e.userProfile.FavoritedRestaurants.length))]),e._v(" 收藏的餐廳")]),t("div",{staticClass:"card-body"},e._l(e.userProfile.FavoritedRestaurants,(function(e){return t("router-link",{key:e.id,attrs:{to:{name:"restaurant",params:{id:e.id}}}},[t("img",{staticClass:"avatar m-1 rounded-1",attrs:{src:e.image,width:"60",height:"60"}})])})),1)])},A=[],S={props:{userProfile:{type:Object,required:!0}}},I=S,J=Object(f["a"])(I,q,A,!1,null,null,null),B=J.exports,D=t("4cce"),T=t("2fa3"),z=t("2f62"),G={name:"User",components:{UserProfileCard:v,UserFollowingsCard:b,UserFollowersCard:x,UserCommentsCard:$,UserFavoritedRestaurantsCard:B},data:function(){return{userProfile:{id:-1,name:"",email:"",isAdmin:!1,image:"",Comments:[],FavoritedRestaurants:[],Followers:[],Followings:[]},isFollowed:!1}},computed:Object(l["a"])({},Object(z["b"])(["currentUser"])),created:function(){var e=this.$route.params.id;this.fetchUserProfile(e)},beforeRouteUpdate:function(e,r,t){var s=e.params.id;this.fetchUserProfile(s),t()},methods:{fetchUserProfile:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,D["a"].getUser({userId:e});case 3:if(s=t.sent,a=s.data,0!==a.profile.name.length){t.next=7;break}throw new Error("error");case 7:r.userProfile=Object(l["a"])(Object(l["a"])({},r.userProfile),a.profile),r.isFollowed=a.isFollowed,t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](0),T["a"].fire({icon:"error",title:"無法取得用戶資料，請稍後再試"});case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))()},toggleFollowingStatus:function(e){var r=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a,i,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e===r.currentUser.id){t.next=21;break}if(!r.isFollowed){t.next=13;break}return t.next=5,D["a"].deleteFollowing({userId:e});case 5:if(s=t.sent,a=s.data,"success"===a.status){t.next=9;break}throw new Error(a.message);case 9:r.isFollowed=!1,r.userProfile.Followers=r.userProfile.Followers.filter((function(e){return e.id!==r.currentUser.id})),t.next=21;break;case 13:return t.next=15,D["a"].addFollowing({userId:e});case 15:if(i=t.sent,l=i.data,"success"===l.status){t.next=19;break}throw new Error(l.message);case 19:r.isFollowed=!0,r.userProfile.Followers.push(r.currentUser);case 21:t.next=26;break;case 23:t.prev=23,t.t0=t["catch"](0),T["a"].fire({icon:"error",title:"無法更新追蹤狀態，請稍後再試"});case 26:case"end":return t.stop()}}),t,null,[[0,23]])})))()}}},H=G,K=Object(f["a"])(H,s,a,!1,null,null,null);r["default"]=K.exports}}]);
//# sourceMappingURL=chunk-2d0ab43a.7ffffcd0.js.map